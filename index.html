<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PrimeZilla — Início</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="topo">
  <div class="brand">
    <img src="https://res.cloudinary.com/duwsueept/image/upload/jq5bm4gwdwi3kpxgrago" class="logo" alt="PrimeZilla">
  </div>
  <nav class="nav">
    <a href="index.html" class="ativo">Início</a>
    <a href="produtos.html">Produtos</a>
    <a href="admin.html">Admin</a>
    <a href="contato.html">Contato</a>
  </nav>
</header>

<main class="container">

  <h2>Destaques</h2>

  <!-- Filtros iguais aos da aba Produtos -->
  <div class="cats">
    <button class="catBtn" data-cat="all">Todos</button>
    <button class="catBtn" data-cat="pods">Pods</button>
    <button class="catBtn" data-cat="acessorios">Acessórios</button>
    <button class="catBtn" data-cat="eletronicos">Eletrônicos</button>
    <button class="catBtn" data-cat="outros">Outros</button>
  </div>

  <div id="productsGrid" class="grid">Carregando...</div>

</main>

<footer class="footer">
  © 2025 PrimeZilla — SITE CRIADO POR @JHON_LORRAN_
</footer>

<!-- SCRIPT DO FIREBASE QUE VOCÊ MANDOU -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDlzVS8ZkI4bVAmcFyKH1PDojvTXGYXyso",
    authDomain: "primezilla-70b94.firebaseapp.com",
    projectId: "primezilla-70b94",
    storageBucket: "primezilla-70b94.firebasestorage.app",
    appId: "1:910803172382:web:db82186d77b8281f13020f"
  };

  const PHONE = "5567992018672";

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  function esc(s){ return String(s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  const grid = document.getElementById('productsGrid');
  const catButtons = Array.from(document.querySelectorAll('.catBtn'));
  let produtos = [];

  // carregar Firestore
  const q = query(collection(db,"products"), orderBy("createdAt","desc"));
  onSnapshot(q, snap => {
    produtos = [];
    snap.forEach(doc => produtos.push({ id: doc.id, ...doc.data() }));
    render("all");
  });

  function render(filter){
    grid.innerHTML = "";

    produtos.forEach(p => {
      if (!p.active) return;
      if(filter !== "all" && String(p.category||"").toLowerCase() !== filter) return;

      const img = p.imageUrl || p.image || "placeholder.png";
      const priceText = p.price ? `${p.currency||"R$"} ${Number(p.price).toFixed(2)}` : "Consultar valores";

      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <div class="media"><img src="${esc(img)}"></div>
        <div class="info">
          <h3>${esc(p.name)}</h3>
          <p class="price">${esc(priceText)}</p>
          <div class="controls">
            <label>Qtd
              <select class="qty"><option>1</option><option>2</option><option>3</option></select>
            </label>
            <label>${p.type==='pod'?'Sabor':'Cor'}
              <select class="variant">${(p.options||[]).map(o=>`<option>${esc(o)}</option>`).join("")}</select>
            </label>
            <label>Pagamento
              <select class="pay"><option>PIX</option><option>Dinheiro</option><option>Cartão</option></select>
            </label>
            <button class="btnBuy botao">Comprar (WhatsApp)</button>
          </div>
        </div>
      `;

      card.querySelector(".btnBuy").addEventListener("click", () => {
        const qtd = card.querySelector(".qty").value;
        const variant = card.querySelector(".variant").value;
        const pay = card.querySelector(".pay").value;

        const msg = encodeURIComponent(
          `Olá! Tenho interesse em: ${p.name}\nQuantidade: ${qtd}\nVariante: ${variant}\nPagamento: ${pay}`
        );

        window.open(`https://wa.me/${PHONE}?text=${msg}`, "_blank");
      });

      grid.appendChild(card);
    });

    if(!grid.children.length){
      grid.innerHTML = "<p>Nenhum produto nesta categoria.</p>";
    }
  }

  catButtons.forEach(btn => btn.addEventListener("click", () => {
    catButtons.forEach(b=>b.classList.remove("ativo-cat"));
    btn.classList.add("ativo-cat");
    render(btn.dataset.cat);
  }));
</script>

<style>
/* MESMO ESTILO QUE A ABA PRODUTOS */
.grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));}
.card{background:#0b2230;border-radius:8px;padding:10px;color:#e6f7ff;display:flex;gap:10px;align-items:flex-start}
.card .media img{width:100px;height:100px;object-fit:cover;border-radius:6px}
.card .info h3{margin:0 0 6px 0}
.price{font-weight:700;margin:6px 0}
.botao{background:linear-gradient(90deg,#00d4ff,#007ac1);color:#001826;padding:8px;border-radius:6px;border:none;cursor:pointer}
.ativo-cat{outline:2px solid rgba(0,212,255,0.12)}
</style>

</body>
</html>
